"use strict";var J=Object.create;var H=Object.defineProperty;var Q=Object.getOwnPropertyDescriptor;var W=Object.getOwnPropertyNames;var X=Object.getPrototypeOf,Y=Object.prototype.hasOwnProperty;var Z=(e,t)=>{for(var n in t)H(e,n,{get:t[n],enumerable:!0})},K=(e,t,n,r)=>{if(t&&typeof t=="object"||typeof t=="function")for(let o of W(t))!Y.call(e,o)&&o!==n&&H(e,o,{get:()=>t[o],enumerable:!(r=Q(t,o))||r.enumerable});return e};var ee=(e,t,n)=>(n=e!=null?J(X(e)):{},K(t||!e||!e.__esModule?H(n,"default",{value:e,enumerable:!0}):n,e)),te=e=>K(H({},"__esModule",{value:!0}),e);var se={};Z(se,{default:()=>q});module.exports=te(se);var i=ee(require("react"));var E=e=>{if(!e)return;let t=j(e);return e.innerText.at(t-1)},w=({mentionClassname:e,editorEl:t,highlightEl:n,value:r,label:o,trigger:c})=>{let l=document.createElement("span");l.className=e,l.setAttribute("trigger",c),l.setAttribute("value",r),l.contentEditable="false",l.innerText=o,S(l,n);let p=document.createTextNode("\xA0");S(p,l),t.removeChild(n),n.parentNode?.removeChild(n),R(t),L(t)},F=(e,t)=>{let n=document.createTextNode(t.innerText);S(n,t),t.parentNode?t.parentNode.removeChild(t):e.removeChild(t)},A=e=>{let t=e.childNodes,n=t.length;for(let r=n;r>0;r--){let o=t[r];if(o?.nodeName==="#text")return;o?.nodeName==="BR"&&o.parentNode?.removeChild(o)}},O=e=>{if(!e)return;let t=e.getElementsByTagName("font");if(t.length){for(let n=0;n<t.length;n++){let r=t[n].innerText,o=document.createTextNode(r);t[n].parentNode?.appendChild(o),t[n].parentNode?.removeChild(t[n])}L(e)}},ne=(e,t)=>{let n=e.childNodes.length-1,r;for(let o=0;o<=n;o++){let c=e.childNodes[o];if(c.nodeName!=="#text"&&(r=c),c===t)break}return r},_=(e,t)=>{if(!t)return e.childNodes[e.childNodes.length-1];let n=e.childNodes.length-1,r;for(let o=0;o<=n&&(r=e.childNodes[o],r!==t);o++);return r},j=e=>{let t=0;if(window.getSelection){var n=window.getSelection()?.getRangeAt(0);if(!n)return t;var r=n.cloneRange();r.selectNodeContents(e),r.setEnd(n.endContainer,n.endOffset),t=r.toString().length}return t},P=(e,t)=>{let r=window.getSelection()?.anchorNode;if(!r)return;let o=j(e),c=0;for(let C=0;C<e.childNodes.length;C++){let g=e.childNodes[C];if(g===r)break;g.innerText?c+=g.innerText.length:c+=g.nodeValue?.length||0}if(r===e||c===o){o===0&&e.firstChild?e.insertBefore(t,e.firstChild):e.appendChild(t);return}let l;e.firstChild===r?l=o:l=o-c;let p=document.createTextNode(r.nodeValue?.substring(0,l)||""),h=document.createTextNode(r.nodeValue?.substring(l)||""),s=r.nextSibling;r.parentNode?.removeChild(r),s?(e.insertBefore(h,s),e.insertBefore(t,h),e.insertBefore(p,t)):(e.appendChild(p),e.appendChild(t),e.appendChild(h))},S=(e,t)=>{t.parentNode?.insertBefore(e,t.nextSibling)},L=e=>{let t=window.getSelection(),n=e||t?.anchorNode;n&&t?.collapse(n,n.childNodes.length)},R=e=>{let t=ne(e);t?.scrollIntoView&&t.scrollIntoView()};var U=e=>{let t=/(<[^>]+>)([^<]+)<\/[^>]+>/g;return e.replace(/&nbsp;/g," ").replace(t,(r,o,c)=>{let l=/trigger="(.)"/,p=/value="([^"]+)"/,h=o.match(l),s=o.match(p);if(!h||!s)return c;let C=h[1],g=s[1];return`__${C}[${c}](${g})__ `}).replace(/<[^>]+>/g," ")};(function(){if(!document.getElementById("2d76d2ce1c48b868ea7bbaf5c310ae464f67278ef49d495dbb8ac1501a5660bd")){var e=document.createElement("style");e.id="2d76d2ce1c48b868ea7bbaf5c310ae464f67278ef49d495dbb8ac1501a5660bd",e.textContent=`.react-mentionable-suggestions {
  position: relative;
  padding: 1rem;
  border: 1px solid #ccc;
}

.react-mentionable-input {
  padding: 1rem;
  border: 1px solid #ccc;
}
`,document.head.appendChild(e)}})();var oe=(0,i.forwardRef)((e,t)=>{let{placeHolder:n,inputClass:r,suggestionsClass:o,mentions:c,onChange:l,renderSuggestion:p,disabled:h}=e,s=(0,i.useRef)(),[C,g]=(0,i.useState)(!1),[B,D]=(0,i.useState)([]),z=c.map(a=>a.trigger),v=(0,i.useRef)(!1),d=(0,i.useRef)(),x=(0,i.useRef)([]),u=(0,i.useRef)(),V=a=>{!s.current||!u.current||(w({mentionClassname:c.find(k=>k.trigger===d.current)?.mentionClassname||"",trigger:d.current||"",value:a.value,editorEl:s.current,label:a.label,highlightEl:u.current}),g(!1),v.current=!1)};return(0,i.useEffect)(()=>{h&&s.current&&(s.current.setAttribute("contenteditable","false"),s.current.style.opacity="0.5")},[h]),(0,i.useLayoutEffect)(()=>{if(!s?.current)return;let a=N=>{if(!s.current)return;O(s.current);let f=N.key||E(s.current);if(v.current&&f==="Tab"||f===" "){let m=_(s.current);if(!m)return;let b=m?.nodeValue?.replace(d.current||"","").toLowerCase()||"";u.current&&x.current.length===1&&v.current||x.current.map(T=>T.label).includes(b)?w({mentionClassname:c.find(T=>T.trigger===d.current)?.mentionClassname||"",trigger:d.current||"",value:x.current[0].value,editorEl:s.current,label:x.current[0].label,highlightEl:u.current}):v.current&&x.current.length!==1&&(F(s.current,u.current),L(s.current)),v.current=!1,g(!1)}else if(f==="Backspace"){N.preventDefault();let b=window.getSelection()?.anchorNode;if(!b)return;let T=b.childNodes.length||0,y=b.childNodes[T-1];y?.nodeValue===""&&y?.parentNode?.removeChild(y),A(b),A(s.current),u.current?.innerText.length===1&&(N.preventDefault(),g(!1),v.current=!1)}else if(v.current&&f!==d.current){let m=u.current?.innerText||"",b=m.lastIndexOf(d.current||""),T=m.substr(b+1).replace(/[^\w]/,""),y=new RegExp(T,"i"),I=c.find(M=>M.trigger===d.current),$=c.find(M=>M.trigger===d.current)?.suggestions;Array.isArray(I?.suggestions)?$&&(x.current=$.filter(M=>y.test(M.label)),D(x.current)):I?.suggestions(T).then(M=>{x.current=M.filter(G=>y.test(G.label)),D(x.current)})}l({text:s.current.innerText,markup:U(s.current.innerHTML)})},k=N=>{let f=N.key||E(s.current);if(!(!f||!s.current)){if(f==="Enter"){N.preventDefault();let m=document.createElement("br"),b=document.createTextNode("\u200B");P(s.current,m),S(b,m),L(s.current)}else if(f==="Tab")N.preventDefault();else if(z.includes(f)){if(v.current){N.preventDefault();return}d.current=f,v.current=!0,u.current=document.createElement("span"),u.current.className=`${c.find(m=>m.trigger===d.current)?.highlightClassName}`,u.current.innerText=d.current,u.current.setAttribute("contentEditable","true"),P(s.current,u.current),g(!0),L(u.current),R(s.current),N.preventDefault()}}};s.current.addEventListener("keydown",k),s.current.addEventListener("keyup",a)},[]),i.default.createElement("div",{className:"react-mentionable"},i.default.createElement("div",{className:"react-mentionable-editor-container"},i.default.createElement("div",{placeholder:n,className:`react-mentionable-input ${r}`,ref:a=>{s.current=a,typeof t=="function"?t(a):t&&t.current},contentEditable:!0})),C&&i.default.createElement("div",{className:`react-mentionable-suggestions ${o}`},B&&B.map(a=>p?p(a,V):i.default.createElement("div",{onClick:()=>V(a),key:a.label,className:"react-mentionable-suggestion"},a.label))))}),q=oe;
